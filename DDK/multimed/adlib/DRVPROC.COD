;	Static Name Aliases
;
	TITLE   drvproc.c
	.286p
	.287
INCLUDELIB      MLIBCE
INCLUDELIB	OLDNAMES.LIB
_TEXT	SEGMENT  WORD PUBLIC 'CODE'
_TEXT	ENDS
_DATA	SEGMENT  WORD PUBLIC 'DATA'
_DATA	ENDS
CONST	SEGMENT  WORD PUBLIC 'CONST'
CONST	ENDS
_BSS	SEGMENT  WORD PUBLIC 'BSS'
_BSS	ENDS
$$SYMBOLS	SEGMENT  BYTE PUBLIC 'DEBSYM'
$$SYMBOLS	ENDS
$$TYPES	SEGMENT  BYTE PUBLIC 'DEBTYP'
$$TYPES	ENDS
DGROUP	GROUP	CONST, _BSS, _DATA
	ASSUME DS: DGROUP
	ASSUME  SS: NOTHING
EXTRN	ENABLE:NEAR
EXTRN	DISABLE:NEAR
EXTRN	OUTPUTDEBUGSTR:FAR
EXTRN	DEFDRIVERPROC:FAR
EXTRN	GETPRIVATEPROFILEINT:FAR
EXTRN	_wDebugLevel:WORD
EXTRN	_aszDriverName:BYTE
EXTRN	_aszAdlibDelay:BYTE
EXTRN	_aszSystemIni:BYTE
_BSS      SEGMENT
COMM NEAR	_wWriteDelay:	BYTE:	 2
_BSS      ENDS
_DATA      SEGMENT
$SG2434	DB	0dH,  0aH, 'ADLIB: ',  00H
$SG2435	DB	'DRV_LOAD',  00H
$SG2438	DB	0dH,  0aH, 'ADLIB: ',  00H
$SG2439	DB	'DRV_FREE',  00H
$SG2442	DB	0dH,  0aH, 'ADLIB: ',  00H
$SG2443	DB	'DRV_OPEN',  00H
$SG2446	DB	0dH,  0aH, 'ADLIB: ',  00H
$SG2447	DB	'DRV_CLOSE',  00H
$SG2450	DB	0dH,  0aH, 'ADLIB: ',  00H
$SG2451	DB	'DRV_ENABLE',  00H
$SG2454	DB	0dH,  0aH, 'ADLIB: ',  00H
$SG2455	DB	'DRV_DISABLE',  00H
$SG2458	DB	0dH,  0aH, 'ADLIB: ',  00H
$SG2459	DB	'DRV_QUERYCONFIGURE',  00H
$SG2462	DB	0dH,  0aH, 'ADLIB: ',  00H
$SG2463	DB	'DRV_CONFIGURE',  00H
$SG2466	DB	0dH,  0aH, 'ADLIB: ',  00H
$SG2467	DB	'DRV_INSTALL',  00H
_DATA      ENDS
_TEXT      SEGMENT
	ASSUME	CS: _TEXT
	PUBLIC	DRVLOADINITIALIZE
DRVLOADINITIALIZE	PROC NEAR
;|*** /****************************************************************************
;|***  *
;|***  *   drvproc.c
;|***  *
;|***  *   Copyright (c) 1991-1992 Microsoft Corporation.  All Rights Reserved.
;|***  *
;|***  ***************************************************************************/
;|*** 
;|*** #include <windows.h>
;|*** #include <mmsystem.h>
;|*** #include "adlib.h"
;|*** 
;|*** WORD    wWriteDelay;
;|*** 
;|*** /***************************************************************************
;|***  * @doc INTERNAL
;|***  *
;|***  * @func void | DrvLoadInitialize | Initializes the write delay time.  LibEntry
;|***  *      has already initialized the global wWriteDelay according to the type of
;|***  *      CPU present.
;|***  *                
;|***  * @rdesc Nothing.
;|***  ***************************************************************************/
;|*** static void PASCAL NEAR DrvLoadInitialize(void)
;|*** {
; Line 25
	*** 000000	56 			push	si
;	register si = wDefDelay
;|*** WORD wDefDelay;
;|*** 
;|***     wDefDelay = wWriteDelay;
;|***     wWriteDelay = GetPrivateProfileInt(aszDriverName, aszAdlibDelay,
;|***         wDefDelay, aszSystemIni);
; Line 30
	*** 000001	68 00 00 		push	SEG _aszDriverName
	*** 000004	68 00 00 		push	OFFSET _aszDriverName
	*** 000007	68 00 00 		push	SEG _aszAdlibDelay
	*** 00000a	68 00 00 		push	OFFSET _aszAdlibDelay
	*** 00000d	8b 36 00 00 		mov	si,WORD PTR _wWriteDelay
	*** 000011	56 			push	si
	*** 000012	68 00 00 		push	SEG _aszSystemIni
	*** 000015	68 00 00 		push	OFFSET _aszSystemIni
	*** 000018	9a 00 00 00 00 		call	FAR PTR GETPRIVATEPROFILEINT
	*** 00001d	a3 00 00 		mov	WORD PTR _wWriteDelay,ax
;|***     if (!wWriteDelay)
; Line 31
	*** 000020	0b c0 			or	ax,ax
	*** 000022	75 04 			jne	$EX2413
;|***         wWriteDelay = wDefDelay;
; Line 32
	*** 000024	89 36 00 00 		mov	WORD PTR _wWriteDelay,si
;|*** }
; Line 33
					$EX2413:
	*** 000028	5e 			pop	si
	*** 000029	c3 			ret	

DRVLOADINITIALIZE	ENDP
	PUBLIC	DRIVERPROC
DRIVERPROC	PROC FAR
;|*** 
;|*** /***************************************************************************
;|***  * @doc INTERNAL
;|***  *
;|***  * @api LONG | DriverProc | The entry point for an installable driver.
;|***  *                
;|***  * @parm DWORD | dwDriverId | For most messages, <p dwDriverId> is the DWORD
;|***  *     value that the driver returns in response to a <m DRV_OPEN> message.
;|***  *     Each time that the driver is opened, through the <f DrvOpen> API,
;|***  *     the driver receives a <m DRV_OPEN> message and can return an
;|***  *     arbitrary, non-zero value. The installable driver interface
;|***  *     saves this value and returns a unique driver handle to the 
;|***  *     application. Whenever the application sends a message to the
;|***  *     driver using the driver handle, the interface routes the message
;|***  *     to this entry point and passes the corresponding <p dwDriverId>.
;|***  *     This mechanism allows the driver to use the same or different
;|***  *     identifiers for multiple opens but ensures that driver handles
;|***  *     are unique at the application interface layer.
;|***  *
;|***  *     The following messages are not related to a particular open
;|***  *     instance of the driver. For these messages, the dwDriverId
;|***  *     will always be zero.
;|***  *
;|***  *         DRV_LOAD, DRV_FREE, DRV_ENABLE, DRV_DISABLE, DRV_OPEN
;|***  *
;|***  * @parm HANDLE  | hDriver | This is the handle returned to the
;|***  *     application by the driver interface.
;|***  *          
;|***  * @parm WORD | wMessage | The requested action to be performed. Message
;|***  *     values below <m DRV_RESERVED> are used for globally defined messages.
;|***  *     Message values from <m DRV_RESERVED> to <m DRV_USER> are used for
;|***  *     defined driver protocols. Messages above <m DRV_USER> are used
;|***  *     for driver specific messages.
;|***  *
;|***  * @parm LONG | lParam1 | Data for this message.  Defined separately for
;|***  *     each message
;|***  *
;|***  * @parm LONG | lParam2 | Data for this message.  Defined separately for
;|***  *     each message
;|***  *
;|***  * @rdesc Defined separately for each message. 
;|***  ***************************************************************************/
;|*** LONG FAR PASCAL _loadds DriverProc(DWORD dwDriverID, HANDLE hDriver, WORD wMessage, LONG lParam1, LONG lParam2)
;|*** {
; Line 77
	*** 00002a	55 			push	bp
	*** 00002b	8b ec 			mov	bp,sp
	*** 00002d	1e 			push	ds
	*** 00002e	b8 00 00 		mov	ax,DGROUP
	*** 000031	8e d8 			mov	ds,ax
	ASSUME DS: DGROUP
;	dwDriverID = 18
;	hDriver = 16
;	wMessage = 14
;	lParam1 = 10
;	lParam2 = 6
	*** 000033	8b 4e 0e 		mov	cx,WORD PTR [bp+14]	;wMessage
;|***     switch (wMessage) {
; Line 78
	*** 000036	8b c1 			mov	ax,cx
;|*** 
;|***         case DRV_LOAD:
;|***             D1("DRV_LOAD");
;|*** 
;|***             /*
;|***                Sent to the driver when it is loaded. Always the first
;|***                message received by a driver.
;|*** 
;|***                dwDriverID is 0L. 
;|***                lParam1 is 0L.
;|***                lParam2 is 0L.
;|***                 
;|***                Return 0L to fail the load.
;|*** 
;|***                DefDriverProc will return NON-ZERO so we don't have to
;|***                handle DRV_LOAD
;|***             */
;|*** 
;|***             DrvLoadInitialize();
;|***             return 1L;
;|*** 
;|***         case DRV_FREE:
;|***             D1("DRV_FREE");
;|*** 
;|***             /*
;|***                Sent to the driver when it is about to be discarded. This
;|***                will always be the last message received by a driver before
;|***                it is freed. 
;|*** 
;|***                dwDriverID is 0L. 
;|***                lParam1 is 0L.
;|***                lParam2 is 0L.
;|***                 
;|***                Return value is ignored.
;|***             */
;|*** 
;|***             return 1L;
;|*** 
;|***         case DRV_OPEN:
;|***             D1("DRV_OPEN");
;|***              
;|***             /*
;|***                Sent to the driver when it is opened. 
;|*** 
;|***                dwDriverID is 0L.
;|***                
;|***                lParam1 is a far pointer to a zero-terminated string
;|***                containing the name used to open the driver.
;|***                
;|***                lParam2 is passed through from the drvOpen call.
;|***                 
;|***                Return 0L to fail the open.
;|***  
;|***                DefDriverProc will return ZERO so we do have to
;|***                handle the DRV_OPEN message.
;|***              */
;|*** 
;|***             return 1L;
;|*** 
;|***         case DRV_CLOSE:
;|***             D1("DRV_CLOSE");
;|***            
;|***             /*
;|***                Sent to the driver when it is closed. Drivers are unloaded
;|***                when the close count reaches zero. 
;|*** 
;|***                dwDriverID is the driver identifier returned from the
;|***                corresponding DRV_OPEN.
;|***                
;|***                lParam1 is passed through from the drvClose call.
;|*** 
;|***                lParam2 is passed through from the drvClose call.
;|***                 
;|***                Return 0L to fail the close.
;|*** 
;|***                DefDriverProc will return ZERO so we do have to
;|***                handle the DRV_CLOSE message.
;|***             */
;|*** 
;|***             return 1L;
;|*** 
;|***         case DRV_ENABLE:
;|***             D1("DRV_ENABLE");
;|***  
;|***             /*
;|***                Sent to the driver when the driver is loaded or reloaded
;|***                and whenever Windows is enabled. Drivers should only
;|***                hook interrupts or expect ANY part of the driver to be in
;|***                memory between enable and disable messages
;|***  
;|***                dwDriverID is 0L. 
;|***                lParam1 is 0L.
;|***                lParam2 is 0L.
;|***                 
;|***                Return value is ignored.
;|***             */
;|*** 
;|***             return Enable() ? 1L : 0L;
;|*** 
;|***         case DRV_DISABLE:
;|***             D1("DRV_DISABLE");
;|*** 
;|***             /*
;|***                Sent to the driver before the driver is freed.
;|***                and whenever Windows is disabled
;|***  
;|***                dwDriverID is 0L. 
;|***                lParam1 is 0L.
;|***                lParam2 is 0L.
;|***                 
;|***                Return value is ignored.
;|***             */
;|*** 
;|***             Disable();
;|***             return 1L;
;|*** 
;|***        case DRV_QUERYCONFIGURE:
;|***             D1("DRV_QUERYCONFIGURE");
;|*** 
;|***             /*
;|***                 Sent to the driver so that applications can
;|***                 determine whether the driver supports custom
;|***                 configuration. The driver should return a
;|***                 non-zero value to indicate that configuration
;|***                 is supported.
;|***                 
;|***                 dwDriverID is the value returned from the DRV_OPEN
;|***                 call that must have succeeded before this message
;|***                 was sent.
;|***  
;|***                 lParam1 is passed from the app and is undefined.
;|***                 lParam2 is passed from the app and is undefined.
;|*** 
;|***                 Return 0L to indicate configuration NOT supported.
;|***             */
;|*** 
;|***             return 0L;        /* we don't do configuration */
;|*** 
;|***        case DRV_CONFIGURE:
;|***             D1("DRV_CONFIGURE");
;|*** 
;|***             /*
;|***                 Sent to the driver so that it can display a custom
;|***                 configuration dialog box.
;|*** 
;|***                 lParam1 is passed from the app. and should contain
;|***                 the parent window handle in the loword.
;|***                 lParam2 is passed from the app and is undefined.
;|*** 
;|***                 Return value is undefined.
;|*** 
;|***                 Drivers should create their own section in system.ini.
;|***                 The section name should be the driver name.
;|***             */
;|*** 
;|***             return DRVCNF_CANCEL;
;|*** 
;|***        case DRV_INSTALL:
;|***             D1("DRV_INSTALL");
;|***             return DRVCNF_RESTART;
;|*** 
;|***         default:
;|***             return DefDriverProc(dwDriverID, hDriver, wMessage, lParam1, lParam2);
;|***         }                  
; Line 242
	*** 000038	48 			dec	ax
	*** 000039	3d 08 00 		cmp	ax,8
	*** 00003c	77 1a 			ja	$SD2468
	*** 00003e	03 c0 			add	ax,ax
	*** 000040	93 			xchg	ax,bx
	*** 000041	2e ff a7 00 00 		jmp	WORD PTR cs:$L2471[bx]
					$L2471:
	*** 000046	00 00 				DW	$SC2432
	*** 000048	00 00 				DW	$SC2448
	*** 00004a	00 00 				DW	$SC2440
	*** 00004c	00 00 				DW	$SC2444
	*** 00004e	00 00 				DW	$SC2452
	*** 000050	00 00 				DW	$SC2436
	*** 000052	00 00 				DW	$SC2460
	*** 000054	00 00 				DW	$SC2456
	*** 000056	00 00 				DW	$SC2464
;|***         default:
; Line 240
					$SD2468:
;|***             return DefDriverProc(dwDriverID, hDriver, wMessage, lParam1, lParam2);
; Line 241
	*** 000058	ff 76 14 		push	WORD PTR [bp+20]
	*** 00005b	ff 76 12 		push	WORD PTR [bp+18]	;dwDriverID
	*** 00005e	ff 76 10 		push	WORD PTR [bp+16]	;hDriver
	*** 000061	51 			push	cx
	*** 000062	ff 76 0c 		push	WORD PTR [bp+12]
	*** 000065	ff 76 0a 		push	WORD PTR [bp+10]	;lParam1
	*** 000068	ff 76 08 		push	WORD PTR [bp+8]
	*** 00006b	ff 76 06 		push	WORD PTR [bp+6]	;lParam2
	*** 00006e	9a 00 00 00 00 		call	FAR PTR DEFDRIVERPROC
	*** 000073	e9 fc 00 		jmp	$EX2427
;|***         case DRV_LOAD:
; Line 80
					$SC2432:
;|***             D1("DRV_LOAD");
; Line 81
	*** 000076	83 3e 00 00 01 		cmp	WORD PTR _wDebugLevel,1
	*** 00007b	72 12 			jb	$I2433
	*** 00007d	1e 			push	ds
	*** 00007e	68 00 00 		push	OFFSET DGROUP:$SG2434
	*** 000081	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
	*** 000086	1e 			push	ds
	*** 000087	68 00 00 		push	OFFSET DGROUP:$SG2435
	*** 00008a	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
;|*** 
;|***             /*
;|***                Sent to the driver when it is loaded. Always the first
;|***                message received by a driver.
;|*** 
;|***                dwDriverID is 0L. 
;|***                lParam1 is 0L.
;|***                lParam2 is 0L.
;|***                 
;|***                Return 0L to fail the load.
;|*** 
;|***                DefDriverProc will return NON-ZERO so we don't have to
;|***                handle DRV_LOAD
;|***             */
;|*** 
;|***             DrvLoadInitialize();
; Line 97
					$I2433:
	*** 00008f	e8 6e ff 		call	DRVLOADINITIALIZE
	*** 000092	e9 87 00 		jmp	$I2437
;|***             return 1L;
;|*** 
;|***         case DRV_FREE:
;|***             D1("DRV_FREE");
;|*** 
;|***             /*
;|***                Sent to the driver when it is about to be discarded. This
;|***                will always be the last message received by a driver before
;|***                it is freed. 
;|*** 
;|***                dwDriverID is 0L. 
;|***                lParam1 is 0L.
;|***                lParam2 is 0L.
;|***                 
;|***                Return value is ignored.
;|***             */
;|*** 
;|***             return 1L;
;|*** 
;|***         case DRV_OPEN:
;|***             D1("DRV_OPEN");
;|***              
;|***             /*
;|***                Sent to the driver when it is opened. 
;|*** 
;|***                dwDriverID is 0L.
;|***                
;|***                lParam1 is a far pointer to a zero-terminated string
;|***                containing the name used to open the driver.
;|***                
;|***                lParam2 is passed through from the drvOpen call.
;|***                 
;|***                Return 0L to fail the open.
;|***  
;|***                DefDriverProc will return ZERO so we do have to
;|***                handle the DRV_OPEN message.
;|***              */
;|*** 
;|***             return 1L;
;|*** 
;|***         case DRV_CLOSE:
;|***             D1("DRV_CLOSE");
;|***            
;|***             /*
;|***                Sent to the driver when it is closed. Drivers are unloaded
;|***                when the close count reaches zero. 
;|*** 
;|***                dwDriverID is the driver identifier returned from the
;|***                corresponding DRV_OPEN.
;|***                
;|***                lParam1 is passed through from the drvClose call.
;|*** 
;|***                lParam2 is passed through from the drvClose call.
;|***                 
;|***                Return 0L to fail the close.
;|*** 
;|***                DefDriverProc will return ZERO so we do have to
;|***                handle the DRV_CLOSE message.
;|***             */
;|*** 
;|***             return 1L;
;|*** 
;|***         case DRV_ENABLE:
; Line 160
					$SC2448:
;|***             D1("DRV_ENABLE");
; Line 161
	*** 000095	83 3e 00 00 01 		cmp	WORD PTR _wDebugLevel,1
	*** 00009a	72 12 			jb	$I2449
	*** 00009c	1e 			push	ds
	*** 00009d	68 00 00 		push	OFFSET DGROUP:$SG2450
	*** 0000a0	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
	*** 0000a5	1e 			push	ds
	*** 0000a6	68 00 00 		push	OFFSET DGROUP:$SG2451
	*** 0000a9	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
;|***  
;|***             /*
;|***                Sent to the driver when the driver is loaded or reloaded
;|***                and whenever Windows is enabled. Drivers should only
;|***                hook interrupts or expect ANY part of the driver to be in
;|***                memory between enable and disable messages
;|***  
;|***                dwDriverID is 0L. 
;|***                lParam1 is 0L.
;|***                lParam2 is 0L.
;|***                 
;|***                Return value is ignored.
;|***             */
;|*** 
;|***             return Enable() ? 1L : 0L;
; Line 176
					$I2449:
	*** 0000ae	e8 00 00 		call	ENABLE
	*** 0000b1	0b c0 			or	ax,ax
	*** 0000b3	75 67 			jne	$I2437
	*** 0000b5	99 			cwd	
	*** 0000b6	e9 b9 00 		jmp	$EX2427
;|***         case DRV_OPEN:
; Line 117
					$SC2440:
;|***             D1("DRV_OPEN");
; Line 118
	*** 0000b9	83 3e 00 00 01 		cmp	WORD PTR _wDebugLevel,1
	*** 0000be	72 5c 			jb	$I2437
	*** 0000c0	1e 			push	ds
	*** 0000c1	68 00 00 		push	OFFSET DGROUP:$SG2442
	*** 0000c4	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
	*** 0000c9	1e 			push	ds
	*** 0000ca	68 00 00 		push	OFFSET DGROUP:$SG2443
	*** 0000cd	eb 48 			jmp	SHORT $L2475
;|***              
;|***             /*
;|***                Sent to the driver when it is opened. 
;|*** 
;|***                dwDriverID is 0L.
;|***                
;|***                lParam1 is a far pointer to a zero-terminated string
;|***                containing the name used to open the driver.
;|***                
;|***                lParam2 is passed through from the drvOpen call.
;|***                 
;|***                Return 0L to fail the open.
;|***  
;|***                DefDriverProc will return ZERO so we do have to
;|***                handle the DRV_OPEN message.
;|***              */
;|*** 
;|***             return 1L;
;|*** 
;|***         case DRV_CLOSE:
; Line 138
					$SC2444:
;|***             D1("DRV_CLOSE");
; Line 139
	*** 0000cf	83 3e 00 00 01 		cmp	WORD PTR _wDebugLevel,1
	*** 0000d4	72 46 			jb	$I2437
	*** 0000d6	1e 			push	ds
	*** 0000d7	68 00 00 		push	OFFSET DGROUP:$SG2446
	*** 0000da	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
	*** 0000df	1e 			push	ds
	*** 0000e0	68 00 00 		push	OFFSET DGROUP:$SG2447
	*** 0000e3	eb 32 			jmp	SHORT $L2475
;|***            
;|***             /*
;|***                Sent to the driver when it is closed. Drivers are unloaded
;|***                when the close count reaches zero. 
;|*** 
;|***                dwDriverID is the driver identifier returned from the
;|***                corresponding DRV_OPEN.
;|***                
;|***                lParam1 is passed through from the drvClose call.
;|*** 
;|***                lParam2 is passed through from the drvClose call.
;|***                 
;|***                Return 0L to fail the close.
;|*** 
;|***                DefDriverProc will return ZERO so we do have to
;|***                handle the DRV_CLOSE message.
;|***             */
;|*** 
;|***             return 1L;
;|*** 
;|***         case DRV_ENABLE:
;|***             D1("DRV_ENABLE");
;|***  
;|***             /*
;|***                Sent to the driver when the driver is loaded or reloaded
;|***                and whenever Windows is enabled. Drivers should only
;|***                hook interrupts or expect ANY part of the driver to be in
;|***                memory between enable and disable messages
;|***  
;|***                dwDriverID is 0L. 
;|***                lParam1 is 0L.
;|***                lParam2 is 0L.
;|***                 
;|***                Return value is ignored.
;|***             */
;|*** 
;|***             return Enable() ? 1L : 0L;
;|*** 
;|***         case DRV_DISABLE:
; Line 178
					$SC2452:
;|***             D1("DRV_DISABLE");
; Line 179
	*** 0000e5	83 3e 00 00 01 		cmp	WORD PTR _wDebugLevel,1
	*** 0000ea	72 12 			jb	$I2453
	*** 0000ec	1e 			push	ds
	*** 0000ed	68 00 00 		push	OFFSET DGROUP:$SG2454
	*** 0000f0	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
	*** 0000f5	1e 			push	ds
	*** 0000f6	68 00 00 		push	OFFSET DGROUP:$SG2455
	*** 0000f9	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
;|*** 
;|***             /*
;|***                Sent to the driver before the driver is freed.
;|***                and whenever Windows is disabled
;|***  
;|***                dwDriverID is 0L. 
;|***                lParam1 is 0L.
;|***                lParam2 is 0L.
;|***                 
;|***                Return value is ignored.
;|***             */
;|*** 
;|***             Disable();
; Line 192
					$I2453:
	*** 0000fe	e8 00 00 		call	DISABLE
;|***             return 1L;
; Line 193
	*** 000101	eb 19 			jmp	SHORT $I2437
;|***         case DRV_FREE:
; Line 100
					$SC2436:
;|***             D1("DRV_FREE");
; Line 101
	*** 000103	83 3e 00 00 01 		cmp	WORD PTR _wDebugLevel,1
	*** 000108	72 12 			jb	$I2437
	*** 00010a	1e 			push	ds
	*** 00010b	68 00 00 		push	OFFSET DGROUP:$SG2438
	*** 00010e	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
	*** 000113	1e 			push	ds
	*** 000114	68 00 00 		push	OFFSET DGROUP:$SG2439
					$L2475:
	*** 000117	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
;|*** 
;|***             /*
;|***                Sent to the driver when it is about to be discarded. This
;|***                will always be the last message received by a driver before
;|***                it is freed. 
;|*** 
;|***                dwDriverID is 0L. 
;|***                lParam1 is 0L.
;|***                lParam2 is 0L.
;|***                 
;|***                Return value is ignored.
;|***             */
;|*** 
;|***             return 1L;
; Line 115
					$I2437:
	*** 00011c	b8 01 00 		mov	ax,1
	*** 00011f	eb 4f 			jmp	SHORT $L2472
;|*** 
;|***         case DRV_OPEN:
;|***             D1("DRV_OPEN");
;|***              
;|***             /*
;|***                Sent to the driver when it is opened. 
;|*** 
;|***                dwDriverID is 0L.
;|***                
;|***                lParam1 is a far pointer to a zero-terminated string
;|***                containing the name used to open the driver.
;|***                
;|***                lParam2 is passed through from the drvOpen call.
;|***                 
;|***                Return 0L to fail the open.
;|***  
;|***                DefDriverProc will return ZERO so we do have to
;|***                handle the DRV_OPEN message.
;|***              */
;|*** 
;|***             return 1L;
;|*** 
;|***         case DRV_CLOSE:
;|***             D1("DRV_CLOSE");
;|***            
;|***             /*
;|***                Sent to the driver when it is closed. Drivers are unloaded
;|***                when the close count reaches zero. 
;|*** 
;|***                dwDriverID is the driver identifier returned from the
;|***                corresponding DRV_OPEN.
;|***                
;|***                lParam1 is passed through from the drvClose call.
;|*** 
;|***                lParam2 is passed through from the drvClose call.
;|***                 
;|***                Return 0L to fail the close.
;|*** 
;|***                DefDriverProc will return ZERO so we do have to
;|***                handle the DRV_CLOSE message.
;|***             */
;|*** 
;|***             return 1L;
;|*** 
;|***         case DRV_ENABLE:
;|***             D1("DRV_ENABLE");
;|***  
;|***             /*
;|***                Sent to the driver when the driver is loaded or reloaded
;|***                and whenever Windows is enabled. Drivers should only
;|***                hook interrupts or expect ANY part of the driver to be in
;|***                memory between enable and disable messages
;|***  
;|***                dwDriverID is 0L. 
;|***                lParam1 is 0L.
;|***                lParam2 is 0L.
;|***                 
;|***                Return value is ignored.
;|***             */
;|*** 
;|***             return Enable() ? 1L : 0L;
;|*** 
;|***         case DRV_DISABLE:
;|***             D1("DRV_DISABLE");
;|*** 
;|***             /*
;|***                Sent to the driver before the driver is freed.
;|***                and whenever Windows is disabled
;|***  
;|***                dwDriverID is 0L. 
;|***                lParam1 is 0L.
;|***                lParam2 is 0L.
;|***                 
;|***                Return value is ignored.
;|***             */
;|*** 
;|***             Disable();
;|***             return 1L;
;|*** 
;|***        case DRV_QUERYCONFIGURE:
;|***             D1("DRV_QUERYCONFIGURE");
;|*** 
;|***             /*
;|***                 Sent to the driver so that applications can
;|***                 determine whether the driver supports custom
;|***                 configuration. The driver should return a
;|***                 non-zero value to indicate that configuration
;|***                 is supported.
;|***                 
;|***                 dwDriverID is the value returned from the DRV_OPEN
;|***                 call that must have succeeded before this message
;|***                 was sent.
;|***  
;|***                 lParam1 is passed from the app and is undefined.
;|***                 lParam2 is passed from the app and is undefined.
;|*** 
;|***                 Return 0L to indicate configuration NOT supported.
;|***             */
;|*** 
;|***             return 0L;        /* we don't do configuration */
;|*** 
;|***        case DRV_CONFIGURE:
; Line 217
					$SC2460:
;|***             D1("DRV_CONFIGURE");
; Line 218
	*** 000121	83 3e 00 00 01 		cmp	WORD PTR _wDebugLevel,1
	*** 000126	72 28 			jb	$I2457
	*** 000128	1e 			push	ds
	*** 000129	68 00 00 		push	OFFSET DGROUP:$SG2462
	*** 00012c	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
	*** 000131	1e 			push	ds
	*** 000132	68 00 00 		push	OFFSET DGROUP:$SG2463
	*** 000135	eb 14 			jmp	SHORT $L2476
;|***        case DRV_QUERYCONFIGURE:
; Line 195
					$SC2456:
;|***             D1("DRV_QUERYCONFIGURE");
; Line 196
	*** 000137	83 3e 00 00 01 		cmp	WORD PTR _wDebugLevel,1
	*** 00013c	72 12 			jb	$I2457
	*** 00013e	1e 			push	ds
	*** 00013f	68 00 00 		push	OFFSET DGROUP:$SG2458
	*** 000142	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
	*** 000147	1e 			push	ds
	*** 000148	68 00 00 		push	OFFSET DGROUP:$SG2459
					$L2476:
	*** 00014b	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
;|*** 
;|***             /*
;|***                 Sent to the driver so that applications can
;|***                 determine whether the driver supports custom
;|***                 configuration. The driver should return a
;|***                 non-zero value to indicate that configuration
;|***                 is supported.
;|***                 
;|***                 dwDriverID is the value returned from the DRV_OPEN
;|***                 call that must have succeeded before this message
;|***                 was sent.
;|***  
;|***                 lParam1 is passed from the app and is undefined.
;|***                 lParam2 is passed from the app and is undefined.
;|*** 
;|***                 Return 0L to indicate configuration NOT supported.
;|***             */
;|*** 
;|***             return 0L;        /* we don't do configuration */
; Line 215
					$I2457:
	*** 000150	33 c0 			xor	ax,ax
	*** 000152	eb 1c 			jmp	SHORT $L2472
;|*** 
;|***        case DRV_CONFIGURE:
;|***             D1("DRV_CONFIGURE");
;|*** 
;|***             /*
;|***                 Sent to the driver so that it can display a custom
;|***                 configuration dialog box.
;|*** 
;|***                 lParam1 is passed from the app. and should contain
;|***                 the parent window handle in the loword.
;|***                 lParam2 is passed from the app and is undefined.
;|*** 
;|***                 Return value is undefined.
;|*** 
;|***                 Drivers should create their own section in system.ini.
;|***                 The section name should be the driver name.
;|***             */
;|*** 
;|***             return DRVCNF_CANCEL;
;|*** 
;|***        case DRV_INSTALL:
; Line 236
					$SC2464:
;|***             D1("DRV_INSTALL");
; Line 237
	*** 000154	83 3e 00 00 01 		cmp	WORD PTR _wDebugLevel,1
	*** 000159	72 12 			jb	$I2465
	*** 00015b	1e 			push	ds
	*** 00015c	68 00 00 		push	OFFSET DGROUP:$SG2466
	*** 00015f	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
	*** 000164	1e 			push	ds
	*** 000165	68 00 00 		push	OFFSET DGROUP:$SG2467
	*** 000168	9a 00 00 00 00 		call	FAR PTR OUTPUTDEBUGSTR
;|***             return DRVCNF_RESTART;
; Line 238
					$I2465:
	*** 00016d	b8 02 00 		mov	ax,2
					$L2472:
	*** 000170	33 d2 			xor	dx,dx
;|*** 
;|***         default:
;|***             return DefDriverProc(dwDriverID, hDriver, wMessage, lParam1, lParam2);
;|***         }                  
;|*** }
; Line 243
					$EX2427:
	*** 000172	1f 			pop	ds
	*** 000173	c9 			leave	
	*** 000174	ca 10 00 		ret	16	;00000010H
	*** 000177	90 			nop	

DRIVERPROC	ENDP
_TEXT	ENDS
END
